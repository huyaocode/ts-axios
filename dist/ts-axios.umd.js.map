{"version":3,"file":"ts-axios.umd.js","sources":["../src/xhr.ts","../src/helpers/util.ts","../src/helpers/url.ts","../src/helpers/data.ts","../src/index.ts"],"sourcesContent":["import { AxiosRequestConfig } from './types'\n\nexport default function xhr(config: AxiosRequestConfig): void {\n  const { data = null, url, method = 'get' } = config\n\n  const request = new XMLHttpRequest()\n\n  request.open(method.toUpperCase(), url, true)\n\n  request.send(data)\n}\n","const objToString = Object.prototype.toString\n\nexport function isDate(val: any): val is Date {\n  return objToString.call(val) === '[object Date]'\n}\n\n// export function isObject(val: any): val is Object {\n//   return val !== null && typeof val === 'object'\n// }\n\n/**\n * 对于 FormData、ArrayBuffer 这些类型，isObject 判断也为 true\n * 只有我们定义的普通JSON式对象才能满足。\n * @param val \n */\nexport function isPlainObject (val: any): val is Object {\n  return toString.call(val) === '[object Object]'\n}","import { isDate, isPlainObject } from './util'\n\nfunction encode(val: string): string {\n  return encodeURIComponent(val)\n    .replace(/%40/g, '@')\n    .replace(/%3A/gi, ':')\n    .replace(/%24/g, '$')\n    .replace(/%2C/gi, ',')\n    .replace(/%20/g, '+')\n    .replace(/%5B/gi, '[')\n    .replace(/%5D/gi, ']')\n}\n\nexport function buildURL(url: string, params?: any): string {\n  if (!params) {\n    return url\n  }\n  const parts: string[] = []\n\n  Object.keys(params).forEach(key => {\n    const val = params[key]\n    if (val === null || val === undefined) {\n      return\n    }\n    let values = []\n    if (Array.isArray(val)) {\n      values = val\n      key += '[]'\n    } else {\n      values = [val]\n    }\n    values.forEach(val => {\n      if (isDate(val)) {\n        val = val.toISOString()\n      } else if (isPlainObject(val)) {\n        val = JSON.stringify(val)\n      }\n      parts.push(`${encode(key)}=${encode(val)}`)\n    })\n  })\n\n  let serializedParams = parts.join('&')\n\n  if (serializedParams) {\n    const hashIndex = url.indexOf('#')\n    if (hashIndex !== -1) {\n      url = url.slice(0, hashIndex)\n    }\n    url += (url.indexOf('?') !== -1 ? '&' : '?') + serializedParams\n  }\n\n  return url\n}\n","import { isPlainObject } from './util'\r\n\r\nexport function transformRequest(data: any): any {\r\n  if (isPlainObject(data)) {\r\n    return JSON.stringify(data)\r\n  }\r\n  return data\r\n}\r\n","import { AxiosRequestConfig } from './types'\nimport xhr from './xhr'\nimport { buildURL } from './helpers/url'\nimport { transformRequest } from './helpers/data';\n\nfunction axios(config: AxiosRequestConfig) {\n  processConfig(config)\n  xhr(config)\n}\n/**\n * 将 param 拼接进 url\n * 将 data 序列化\n */\nfunction processConfig(config: AxiosRequestConfig): void {\n  config.url = transformURL(config)\n  config.data = transformRequestData(config)\n}\n\nfunction transformURL(config: AxiosRequestConfig): string {\n  const { url, params } = config\n  return buildURL(url, params)\n}\n\nfunction transformRequestData(config: AxiosRequestConfig): any {\n  return transformRequest(config.data)\n}\n\nexport default axios\n"],"names":[],"mappings":"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"}